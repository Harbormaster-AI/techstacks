########################################################################
## CircleCI Macros
########################################################################

########################################################################
## CircleCI Docker Image Output - Default is for Java8/MySQL images
########################################################################
#macro( CircleCI_OutputDockerImageDecl )        
    # CircleCI Ruby
    # Postgres image
    docker:
      - image: cimg/#Ruby_Image()
#end##macro( CircleCI_OutputDockerImageDecl )

########################################################################
## CircleCI Run Commands
########################################################################
#macro( CircleCI_RunCommands )
#set( $appName = $aib.getApplicationNameFormatted() )
      - run:
          name: Verify installation of Ruby, SQLite3, and NodeJS
          command: ruby -v && sqlite3 --version && node --version
          
      - run:
          name: Install Yarn and verify version
          command: npm install --global yarn && yarn --version
          
      - run: 
          name: Create an appRoot directory to install into 
          command: mkdir /home/circleci/appRoot

      - run: 
          name: Create the Ruby on Rails project into the appRoot directory
          command: cd /home/circleci/appRoot && rails new ${appName}

      - run: 
          name: Copy the application files from the working directory back to the Git Root
          command: cp -r -n /home/circleci/appRoot/${appName}/ /home/circleci/gitRoot/
          
      - run:
          name: Build/Test...
          command: cd /home/circleci/gitRoot/${appName} && bundle exec rake   
#end###macro( CircleCI_RunCommands )

########################################################################
## CircleCI EnvVarAssignments
########################################################################
#macro( CircleCI_EnvVarAssignments )
#end##macro( CircleCI_EnvVarAssignments )