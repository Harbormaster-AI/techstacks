#macro( determineKotlinType $attribute )
#set( $name = $attribute.getName() )
#set( $type = $attribute.getType() )
#set( $defaultValue = "${esq.quote}${esq.quote}" )
######################################################################
## handle associations and non-associations differently
######################################################################
#if ( $attribute.isFromAssociation() == false )
######################################################################
## handle enums and non-enums differently
######################################################################
#if ( $attribute.isFromEnumerator() == true )
#set( $type = $type )
#set( $defaultValue = "$type.values().get(0)" )
#else
#if( $type.contains("tring") )
#set( $type = "String" )
#set( $defaultValue = "" )
#elseif( $type.contains("loat") )
#set( $type = "Float" )
#set( $defaultValue = "0.0F" )
#elseif( $type.contains("oolean") )
#set( $type = "Boolean" )
#set( $defaultValue = "true" )
#elseif( $type.equalsIgnoreCase("char") )
#set( $type = "Char" )
#set( $defaultValue = "" )
#elseif( $type.equalsIgnoreCase("long") )
#set( $type = "Long" )
#set( $defaultValue = "0L" )
#elseif( $type.equalsIgnoreCase("int") || $type.contains("nteger") )
#set( $type = "Int" )
#set( $defaultValue = 0 )
#elseif( $type.contains("ouble") )
#set( $type = "Double" )
#set( $defaultValue = "0.0D" )
#elseif( $type.contains("hort") )
#set( $type = "Short" )
#set( $defaultValue = 0 )
#elseif( $type.contains("yte") )
#set( $type = "Byte" )
#set( $defaultValue = 0 )
#else ## testing for date/time
#set( $isTimeType = "#isTypeTime( $type )" )
#if ( $isTimeType.length() > 0 )
#set( $type = "Date" )
#set( $defaultValue = "Date()" )
#else
#set( $type = "String" )
#set( $defaultValue = "${esq.quote}${esq.quote}" )
#end##if ( $isTimeType.length() > 0 )
#end### testing for date/time
#end##if ( $attribute.isFromEnumerator() == true )
#else## attribute is from an association
######################################################################
## handle attribute as a single association
######################################################################
#if ( $attribute.isFromSingleValueAssociation() == true )
#if ( $aib.isValueObject( ${attribute.getAssociation().getType()} ) == true )
#set( $type = "${type}" )
#set( $defaultValue = "${type}()" )
#else
#set( $type = "${type}" )
#set( $defaultValue = "${type}()" )
#end##if ( $aib.isValueObject( ${attribute.getAssociation().getType()} == true )
######################################################################
## handle attribute as a multiple association
######################################################################
#else ## attribute is from a multiple assoication
#set( $type = "Set<${attribute.getAssociation().getType()}>" )
#set( $defaultValue = "setOf()" )
#end##if ( $attribution.isFromSingleValueAssociation() == true )
#end##if ( $attribute.isFromAssociation() == false )
${type}#end##macro( determineKotlinType inputType )

#macro( outputKotlinArgDeclarations $class $includeAssociations $includeId $forAggregate $forEntity )
#set( $className = ${class.getName()} )
#set( $lowercaseClassName = ${Utils.lowercaseFirstLetter( ${className} )} )
#set( $pk = "${lowercaseClassName}Id" )
#set( $targetIdentifier = "" )
#set( $includePKs = false )
#set( $valOrVar = "var" )
#if ( $forEntity == false )
#set( $valOrVar = "val" )
#end##if ( $forEntity == false )
#if ( $forAggregate == true )
#set( $targetIdentifier = "@TargetAggregateIdentifier " )
#end##if ( $forAggregate == true )
#set( $attributes  = $class.getDirectAttributes( $includePKs ) )
#if ( $includeAssociations == true )
#set( $attributes = ${class.getAttributesOrderedInHierarchy( $includePKs )} )
#end##if ( $includeAssociations == true )
#if ( $attributes.size() > 0 )
#if ( $includeId == true )
#if ( $forAggregate == false )
#set( $targetIdentifier = "@Id " )
#end##if ( $forAggregate == true )
    ${targetIdentifier}var ${pk}: UUID? = null,
#end##if ( $includeId == true )
#foreach( $attribute in $attributes )
#set( $varDecl = ${valOrVar} )
#set( $name = $attribute.getName() )
#set( $lowercaseName = ${Utils.lowercaseFirstLetter( ${attribute.getName()} )} )
#set( $isValueObject = $aib.isValueObject( $attribute.getType() ) )
#set( $id = "${Utils.lowercaseFirstLetter( $attribute.getType() )}Id" )
#set( $jpa-annotation = "" )
#if ( $attribute.isFromEnumerator() == true )
#set( $varDecl = "@Enumerated(EnumType.STRING) ${valOrVar}")
#elseif ( $isValueObject == true )
#set( $attributeNodes = "#declareAttributeNodes( $attribute )" )
#if( $forEntity == true )
#set( $jpa-annotation = "@Embedded " )
#end##if( $forEntity == true )
#set( $varDecl = "${jpa-annotation}${attributeNodes}    ${valOrVar}")
#elseif ( $attribute.isFromSingleValueAssociation() == true )
#if( $forEntity == true )
#set( $jpa-annotation = "@OneToOne(fetch = FetchType.EAGER) @JoinColumn(name = ${esc.quote}${lowercaseName}${esc.quote}, referencedColumnName = ${esc.quote}${id}${esc.quote}) " )
#end
#set( $varDecl = "${jpa-annotation}${valOrVar}")
#elseif ( $attribute.isFromMultiValueAssociation() == true )
#if ( $forEntity == true )
#set( $isClass = $aib.isClassType( $attribute.getType() ) )
#if ( $isClass == true )
#set( $jpa-annotation = "@OneToMany(fetch = FetchType.EAGER) @JoinColumn(name = ${esc.quote}${lowercaseName}${esc.quote}, referencedColumnName = ${esc.quote}${id}${esc.quote}) " )
#else
#set( $jpa-annotation = "@ElementCollection (fetch = FetchType.EAGER)" )
#end##if ( $isClass == true )
#end##if ( $forEntity == true )
#set( $varDecl = "${jpa-annotation}${valOrVar}")
#end##if ( $attribute.isFromEnumerator() == true )
#set( $kotlinType = "#determineKotlinType( ${attribute} )" )
#if( $forEntity == true  )
#set( $kotlinType = "${kotlinType}? = null" )
#end##if( $forEntity == true && $attribute.canBeNull() == true )
#set( $comma = "" )
#if ( $velocityCount < $attributes.size() )
#set( $comma = "," )
#end##if ( $velocityCount < $attributes.size() )
    ${varDecl} ${lowercaseName}: ${kotlinType}${comma}
#end##foreach( $attribute in $attributes )
#else
#if ( $includeId == true )
    ${targetIdentifier} ${valOrVar} ${pk}: UUID? = null
#end##if ( $includeId == true )
#end##if ( $attributes.size() > 0 )
#end##macro( outputKotlinArgDeclarations $class $includeAssociations $includeId $forAggregate )

#macro ( isTypeTime $type )
#if ( $type.contains("time") || $type.contains("Time") || $type.contains("Date") || $type.contains("date") )
    "Instant"
#end##if ( $types.contains("time") || $types.contains("Time") || $types.contains("Date") )
#end##macro( isTimeType )

#macro( declareAttributeNodes $attributeAsValueObject )
#set( $valueObject = $aib.getValueObject( $attributeAsValueObject.getName() ) )
#set( $valueObjectName = $Utils.lowercaseFirstLetter( ${attributeAsValueObject.getName()} ) )
#set( $includePKs = false )
#set( $attributesForValueObjects = $valueObject.getAttributesOrderedInHierarchy( $includePKs ) )
    @AttributeOverrides(
#foreach( $attribute in $attributesForValueObjects )
#set( $output = "AttributeOverride( name = ${esc.quote}${attribute.getName()}${esc.quote}, column = Column(name = ${esc.quote}${valueObjectName}_${attribute.getName()}${esc.quote}))" )
#if ( $velocityCount < $attributesForValueObjects.size() )
#set( $output = "${output}," )
#end##if ( $velocityCount < $attributesForValueObjects.size() )
      ${output}
#end##foreach( $attribute in $attributesForValueObjects )
    )
#end##macro( declareAttributeNodes $attribute )