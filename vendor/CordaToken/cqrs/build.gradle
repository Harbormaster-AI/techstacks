#set( $systemName = $display.capitalize( $aib.getParam( "corda.token-system-name" ) ) )
plugins {
    id 'java'
    id 'maven-publish'
    id 'application'
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2/')
    }
}

application {
    mainClassName = '${aib.getRootPackageName()}.Application'
}

cordapp {
    targetPlatformVersion corda_platform_version.toInteger()
    minimumPlatformVersion corda_platform_version.toInteger()
    workflow {
        name "${systemName} CorDapp"
        vendor "${aib.getParam("application.company")}"
        // If it's not open source, use "Proprietary"
        licence "Proprietary"
        versionId 1
    }
    signing {
        enabled false
    }
}

apply plugin: 'net.corda.plugins.cordapp'


dependencies {

    cordapp project(":workflows")
    
    implementation 'org.springframework.boot:spring-boot-starter-web:2.5.1'
    implementation 'org.springframework:spring-messaging:5.3.12'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa:2.5.1'
    implementation 'org.springframework.boot:spring-boot-starter-actuator:2.5.1'
    implementation 'org.axonframework:axon-spring-boot-starter:4.4'
    implementation 'org.axonframework.extensions.reactor:axon-reactor-spring-boot-starter:4.5'
    implementation 'org.axonframework.extensions.reactor:axon-reactor-spring-boot-autoconfigure:4.5'
    implementation 'org.axonframework:axon-micrometer:4.4'
#if ( $aib.getParam( "axon-framework.event-store-type") == "mongodb" || $aib.getParam( "axon-framework.entity-store-type") == "mongodb" )  
    implementation 'org.springframework.boot:spring-boot-starter-data-mongodb:2.5.1'
    implementation 'org.axonframework.extensions.mongo:axon-mongo:4.5'
#end    
    implementation 'io.projectreactor:reactor-core:3.4.6'
    implementation 'org.projectlombok:lombok:1.18.20'
    implementation 'org.slf4j:slf4j-ext:1.7.30'
    implementation 'org.apache.commons:commons-lang3:3.12.0'
    implementation 'io.springfox:springfox-boot-starter:3.0.0'
    implementation 'com.thoughtworks.xstream:xstream:1.4.15'
    implementation 'org.junit.jupiter:junit-jupiter-api:5.3.1'
    implementation 'org.junit.jupiter:junit-jupiter-engine:5.3.1'
	implementation 'javax.xml.bind:jaxb-api:2.3.0'

    // Corda dependencies.
    compile "$corda_release_group:corda-rpc:$corda_release_version"
	
    runtimeOnly 'com.h2database:h2:1.4.200'
}

group = '${aib.getRootPackageName()}'
version = '${aib.getParam("application.version")}'
description = '${aib.getParam("application.app name")}'
java.sourceCompatibility = JavaVersion.VERSION_1_8

publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}
